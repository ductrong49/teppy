<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PICKLEBALL CUP</title>

<style>
  body{
    margin:0;
    font-family:Arial, sans-serif;
    background:url("image.jpg") center/cover fixed;
    padding:18px;
  }

  h1,h2,h3{
    text-align:center;
    margin:0;
    padding:0;
    color:#fff;
    text-shadow:2px 2px 4px #000;
  }

  h1{ font-size:1.7rem; margin-top:6px; }
  h2{ font-size:1.4rem; }
  h3{ font-size:1.2rem; margin-bottom:20px; }

  /* KHỐI VUỐT NGANG */
  .scroll-row{
    display:flex;
    gap:16px;
    overflow-x:auto;
    padding-bottom:12px;
  }
  .scroll-block{
    min-width:180px;
    background:#ffffffdd;
    padding:10px;
    border-radius:12px;
    border:2px solid #333;
  }

  .block{
    background:#ffffffdd;
    padding:14px;
    border-radius:12px;
    margin:25px 0;
    border:2px solid #444;
  }

  .section-title{
    font-weight:bold;
    background:#eee;
    padding:6px;
    margin-bottom:10px;
    border-left:5px solid #333;
  }

  table{
    width:100%;
    border-collapse:collapse;
  }
  td,th{
    border:1px solid #444;
    padding:6px 6px;
    text-align:center;
  }
</style>

<script src="https://www.gstatic.com/charts/loader.js"></script>
<script>
google.charts.load('current', {'packages':['table']});

const SHEET_ID = "1QOnDy3RJydEpNXnuTdRzUTwCNohp00FzZxA7xCraXAY";

/* Hàm load sheet */
function loadSheet(sheetName, range, callback){
  let query = new google.visualization.Query(
    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?sheet=${sheetName}&range=${range}`
  );
  query.send(res=>{
    if(res.isError()){ callback(null); return; }
    callback(res.getDataTable());
  });
}

/* Chuyển thành HTML table */
function tableToHTML(data){
  let html = "<table><tbody>";
  for(let r=0; r<data.getNumberOfRows(); r++){
    html += "<tr>";
    for(let c=0;c<data.getNumberOfColumns();c++){
      html += `<td>${data.getValue(r,c) ?? ""}</td>`;
    }
    html += "</tr>";
  }
  html += "</tbody></table>";
  return html;
}

/* =======================================
   1) SHEET DOI – 4 KHỐI VUỐT NGANG
======================================= */
function loadDoi(){
  const ranges = [
    "A1:B5",
    "A7:B11",
    "A13:B17",
    "A19:B23"
  ];
  const labels = ["Bảng A","Bảng B","Bảng C","Bảng D"];

  let html = "";
  let done = 0;

  ranges.forEach((range, idx)=>{
    loadSheet("doi", range, (data)=>{
      html += `
        <div class="scroll-block">
          <div class="section-title">${labels[idx]}</div>
          ${tableToHTML(data)}
        </div>
      `;
      done++;
      if(done === 4){
        document.getElementById("sheet-doi").innerHTML =
          `<div class="scroll-row">${html}</div>`;
      }
    });
  });
}

/* =======================================
   2) SHEET BANG – 4 KHỐI DỌC
======================================= */
function loadBang(){
  const ranges = [
    "A2:G8",
    "A11:G17",
    "A20:G26",
    "A29:G35"
  ];

  let html = "";
  let done = 0;

  ranges.forEach((range, idx)=>{
    loadSheet("bang", range, (data)=>{
      html += `
        <div class="section-title">Khối ${idx+1}</div>
        ${tableToHTML(data)}
      `;
      done++;
      if(done === 4){
        document.getElementById("sheet-bang").innerHTML = html;
      }
    });
  });
}

/* 3 sheet còn lại */
function load18(){
  loadSheet("1.8", "A1:E12", (data)=>{
    document.getElementById("sheet-18").innerHTML = tableToHTML(data);
  });
}

function loadBk(){
  loadSheet("bk", "A1:D7", (data)=>{
    document.getElementById("sheet-bk").innerHTML = tableToHTML(data);
  });
}

function loadCk(){
  loadSheet("ck", "A2:C4", (data)=>{
    document.getElementById("sheet-ck").innerHTML = tableToHTML(data);
  });
}


/* Auto reload mỗi 1 giây */
function reloadAll(){
  loadDoi();
  loadBang();
  load18();
  loadBk();
  loadCk();
}

google.charts.setOnLoadCallback(()=>{
  reloadAll();
  setInterval(reloadAll, 1000);
});
</script>

</head>
<body>

<h2>TEPPY and LADIES</h2>
<h1>PICKLEBALL CUP</h1>
<h3>21/12/2025</h3>

<div class="block">
  <div class="section-title">DANH SÁCH ĐỘI</div>
  <div id="sheet-doi"></div>
</div>

<div class="block">
  <div class="section-title">BẢNG THI ĐẤU</div>
  <div id="sheet-bang"></div>
</div>

<div class="block">
  <div class="section-title">BẢNG 1.8</div>
  <div id="sheet-18"></div>
</div>

<div class="block">
  <div class="section-title">BK</div>
  <div id="sheet-bk"></div>
</div>

<div class="block">
  <div class="section-title">CK</div>
  <div id="sheet-ck"></div>
</div>

</body>
</html>
