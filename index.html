<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>BẢNG THI ĐẤU</title>

<style>
  *, *::before, *::after { box-sizing: border-box; }
  html,body { margin: 0; padding: 0; -webkit-text-size-adjust: 100%; }

  :root{
    --bg:#f4f7fb;
    --card-bg: rgba(255,255,255,0.9);
    --accent-1: #e53e3e;
    --accent-2: #2b6cb0;
    --radius: 12px;
    --gap: 12px;
  }

  body{
    font-family: Arial, "Helvetica Neue", sans-serif;
    background: url("image.jpg") center/cover no-repeat;
    padding: 14px;
    font-size: clamp(15px,4.2vw,20px);
  }

  .container{
    max-width: 980px;
    margin: 0 auto;
  }

  h1,h2,h3{
    text-align:center; margin:0; padding:0; line-height:1.2;
  }
  h1{ font-size:1.25rem; margin-bottom:4px; }
  h2{ font-size:1rem; margin-bottom:6px; }
  h3{ font-size:.9rem; margin-bottom:10px; }

  /* ====== TOP SCROLL GROUPS ====== */
  .top-scroll{
    display:flex;
    overflow-x:auto;
    gap:12px;
    padding:12px 0;
  }
  .top-card{
    min-width:120px;
    background:var(--card-bg);
    border-radius:10px;
    border:2px solid var(--accent-2);
    padding:10px;
    text-align:center;
    font-size:0.82rem;
    box-shadow:0 2px 6px rgba(0,0,0,0.12);
    white-space:nowrap;
  }

  /* ====== KHỐI BẢNG ====== */
  .group{
    margin: 28px 0; 
    padding: 12px;
    background: var(--card-bg);
    border-radius: var(--radius);
    border: 3px solid var(--accent-2);
    box-shadow: 0 4px 12px rgba(0,0,0,0.12);
  }
  .group-title{
    text-align:center;
    font-weight:700;
    margin-bottom:10px;
    font-size:1rem;
  }

  /* ====== BẢNG ====== */
  table{
    width:100%;
    border-collapse:collapse;
    font-size:0.78rem;
  }
  th,td{
    border:1px solid #555;
    padding:4px 5px;
    text-align:center;
    background:white;
    word-break:break-word;
  }
  th{ background:#c6e2ff; font-weight:700; font-size:0.80rem; }

  @media(max-width:420px){
    th,td{ font-size:0.72rem; padding:3px 4px; }
  }
</style>
</head>

<body>
<div class="container">

  <h1>TEPPY and LADIES</h1>
  <h2>PICKLEBALL CUP</h2>
  <h3>21/12/2025</h3>

  <!-- KHỐI NGANG TỪ I1:J35 -->
  <div id="topGroups" class="top-scroll"></div>

  <!-- BẢNG CHÍNH -->
  <div id="groups"></div>

  <!-- BẢNG 1.8 -->
  <div id="sheet18"></div>

  <!-- BẢNG bk.ck -->
  <div id="sheetbk"></div>

  <!-- BẢNG ck (A3:C4) -->
  <div id="sheetck"></div>

</div>

<script>
/* ========== CONFIG ========== */
const SHEET_ID = "1QOnDy3RJydEpNXnuTdRzUTwCNohp00FzZxA7xCraXAY";

const API = (sheet) =>
  `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?sheet=${sheet}`;

/* ========== LOAD GOOGLE SHEET ========== */
async function loadSheet(sheetName){
  const res = await fetch(API(sheetName));
  let text = await res.text();
  text = text.substring(text.indexOf("(")+1, text.lastIndexOf(")"));
  const json = JSON.parse(text);
  return json.table.rows.map(r => r.c ? r.c.map(c => c ? c.v : "") : []);
}

/* ========== RENDER TOP SCROLL CARDS (I:J) ========== */
function renderTopGroups(rows){
  let html = "";
  rows.forEach(r=>{
    const a = r[0] ?? "";
    const b = r[1] ?? "";
    if(!a && !b) return;
    html += `
      <div class="top-card">
        <div><b>${a}</b></div>
        <div>${b}</div>
      </div>
    `;
  });
  document.getElementById("topGroups").innerHTML = html;
}

/* ========== RENDER TABLE ========== */
function renderTable(range, colStart, colEnd, title, target){
  let html = `
    <div class="group">
      <div class="group-title">${title}</div>
      <table>
  `;

  range.forEach((row, idx)=>{
    html += "<tr>";
    const cells = row.slice(colStart, colEnd);
    for(let i=0;i<(colEnd-colStart);i++){
      const cell = cells[i] ?? "";
      html += idx < 1
        ? `<th>${escapeHtml(cell)}</th>`
        : `<td>${escapeHtml(cell)}</td>`;
    }
    html += "</tr>";
  });

  html += "</table></div>";
  document.getElementById(target).innerHTML += html;
}

function escapeHtml(s){
  return String(s).replace(/[&<>"']/g,m=>(
    {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]
  ));
}

/* ========== MAIN ========== */
async function loadAll(){

  /* --- sheet bang --- */
  const bang = await loadSheet("bang");

  /* TOP GROUPS — I1:J35 */
  renderTopGroups(
    bang.slice(0,35).map(r => r.slice(8,10))   // cột I (8), J (9)
  );

  /* BẢNG CHÍNH */
  renderTable(bang.slice(0,8), 0, 7, "BẢNG CHÍNH (A1:G8)", "groups");
  renderTable(bang.slice(9,17), 0, 7, "BẢNG CHÍNH (A10:G17)", "groups");
  renderTable(bang.slice(18,26), 0, 7, "BẢNG CHÍNH (A19:G26)", "groups");
  renderTable(bang.slice(27,35), 0, 7, "BẢNG CHÍNH (A28:G35)", "groups");

  /* sheet 1.8 */
  const s18 = await loadSheet("1.8");
  renderTable(s18.slice(0,13), 0, 5, "BẢNG PHỤ — Sheet 1.8 (A1:E13)", "sheet18");

  /* sheet bk.ck */
  const sbk = await loadSheet("bk.ck");
  renderTable(sbk.slice(0,15), 0, 4, "BẢNG PHỤ — Sheet bk.ck (A1:D15)", "sheetbk");

  /* sheet ck */
  const sck = await loadSheet("ck");
  renderTable(sck.slice(2,4), 0, 3, "BẢNG PHỤ — Sheet ck (A3:C4)", "sheetck");
}

loadAll();
</script>

</body>
</html>
