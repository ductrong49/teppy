<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hiển thị 5 Sheet</title>

<style>
  body{
    margin:0;
    font-family:Arial, sans-serif;
    background:url("image.jpg") center/cover fixed;
    padding:20px;
  }
  h2{
    background:#ffffffcc;
    padding:10px;
    border-radius:8px;
  }
  .block{
    background:#ffffffdd;
    padding:12px;
    border-radius:10px;
    margin-bottom:25px;
    border:2px solid #444;
  }
  table{
    width:100%;
    border-collapse:collapse;
    margin-bottom:20px;
  }

  td,th{
    border:1px solid #444;
    padding:6px 8px;

    /* NGĂN XUỐNG DÒNG + TỰ THU NHỎ CHỮ */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: clamp(12px, 1.4vw, 18px);
  }

  .section-title{
    padding:6px;
    font-weight:bold;
    background:#eee;
    margin:15px 0 5px;
    border-left:5px solid #333;

    white-space: nowrap;
    font-size: clamp(14px, 1.6vw, 20px);
  }
</style>

<script src="https://www.gstatic.com/charts/loader.js"></script>
<script>
google.charts.load('current', {'packages':['table']});

const SHEET_ID = "1QOnDy3RJydEpNXnuTdRzUTwCNohp00FzZxA7xCraXAY";

/* Load 1 sheet */
function loadSheet(sheetName, range, callback){
  let query = new google.visualization.Query(
    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?sheet=${sheetName}&range=${range}`
  );
  query.send((res)=>{
    if(res.isError()){ callback(null); return; }
    callback(res.getDataTable());
  });
}

/* Convert DataTable to HTML */
function tableToHTML(data){
  let html = "<table><tbody>";

  for(let r=0; r<data.getNumberOfRows(); r++){
    html += "<tr>";
    for(let c=0;c<data.getNumberOfColumns();c++){
      html += `<td>${data.getValue(r,c) ?? ""}</td>`;
    }
    html += "</tr>";
  }

  html += "</tbody></table>";
  return html;
}

/* --------------------------- */
/* 1) SHEET DOI – ĐÚNG THỨ TỰ */
/* --------------------------- */
function loadDoi(){
  const ranges = [
    "A1:B5",   // Bảng A
    "A7:B11",  // Bảng B
    "A13:B17", // Bảng C
    "A19:B23"  // Bảng D
  ];

  const labels = ["Bảng A","Bảng B","Bảng C","Bảng D"];

  let html = "";
  let done = 0;

  ranges.forEach((range, idx)=>{
    loadSheet("doi", range, (data)=>{
      html += `<div class="section-title">${labels[idx]}</div>`;
      html += tableToHTML(data);

      done++;
      if(done === 4){
        document.getElementById("sheet-doi").innerHTML = html;
      }
    });
  });
}

/* --------------------------- */
/* 2) SHEET BANG – ĐÚNG THỨ TỰ */
/* --------------------------- */
function loadBang(){
  const ranges = [
    "A2:G8",
    "A11:G17",
    "A20:G26",
    "A29:G35"
  ];

  let html = "";
  let done = 0;

  ranges.forEach((range, idx)=>{
    loadSheet("bang", range, (data)=>{
      html += `<div class="section-title">Khối ${idx+1}</div>`;
      html += tableToHTML(data);

      done++;
      if(done === 4){
        document.getElementById("sheet-bang").innerHTML = html;
      }
    });
  });
}

/* Sheet đơn */
function load18(){
  loadSheet("1.8", "A1:E12", (data)=>{
    document.getElementById("sheet-18").innerHTML = tableToHTML(data);
  });
}

function loadBk(){
  loadSheet("bk", "A1:D7", (data)=>{
    document.getElementById("sheet-bk").innerHTML = tableToHTML(data);
  });
}

function loadCk(){
  loadSheet("ck", "A2:C4", (data)=>{
    document.getElementById("sheet-ck").innerHTML = tableToHTML(data);
  });
}

google.charts.setOnLoadCallback(()=>{
  loadDoi();
  loadBang();
  load18();
  loadBk();
  loadCk();
});
</script>

</head>
<body>

<h1 style="color:white;text-shadow:2px 2px 4px #000;">HIỂN THỊ DỮ LIỆU 5 SHEET</h1>

<div class="block">
  <h2>SHEET: ĐỘI</h2>
  <div id="sheet-doi"></div>
</div>

<div class="block">
  <h2>SHEET: BẢNG</h2>
  <div id="sheet-bang"></div>
</div>

<div class="block">
  <h2>SHEET: 1.8</h2>
  <div id="sheet-18"></div>
</div>

<div class="block">
  <h2>SHEET: BK</h2>
  <div id="sheet-bk"></div>
</div>

<div class="block">
  <h2>SHEET: CK</h2>
  <div id="sheet-ck"></div>
</div>

</body>
</html>
