<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>BẢNG THI ĐẤU</title>

<style>
  body{margin:0; background:#f6f7fb; font-family:Arial, sans-serif;}
  .wrap{padding:10px;}

  /* --- TOP GROUPS (sheet doi) --- */
  .top-groups{
    display:flex; gap:10px; overflow-x:auto;
    padding:10px 0; margin-bottom:20px;
  }
  .group-box{
    min-width:180px; background:white; border-radius:10px;
    padding:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1);
  }
  .group-title{font-weight:bold; margin-bottom:6px; font-size:16px; color:#333;}
  table{width:100%; border-collapse:collapse; background:white;}
  td, th{padding:6px 8px; border:1px solid #ddd; font-size:14px;}

  .section-title{
    font-weight:bold; font-size:18px;
    margin:15px 0 10px; color:#333;
  }
</style>
</head>

<body>
<div class="wrap">

  <!-- SHEET 1: DOI -->
  <div class="section-title">DANH SÁCH ĐỘI</div>
  <div id="topGroups" class="top-groups"></div>

  <!-- SHEET 2 -->
  <div class="section-title">BẢNG ĐẤU</div>
  <div id="sheet_bang"></div>

  <!-- SHEET 3 -->
  <div class="section-title">VÒNG 1/8</div>
  <div id="sheet_18"></div>

  <!-- SHEET 4 -->
  <div class="section-title">BÁN KẾT – CHUNG KẾT</div>
  <div id="sheet_bkck"></div>

  <!-- SHEET 5 -->
  <div class="section-title">CHUNG KẾT</div>
  <div id="sheet_ck"></div>

</div>

<script>
const SHEET_ID = "1QOnDy3RJydEpNXnuTdRzUTwCNohp00FzZxA7xCraXAY";
const API = (gid)=>`https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?gid=${gid}&tqx=out:json`;

/* LOAD SHEET — ổn định, ép đủ 30 cột */
async function loadSheet(gid){
  const res = await fetch(API(gid));
  let text = await res.text();
  text = text.substring(text.indexOf("(")+1, text.lastIndexOf(")"));
  const json = JSON.parse(text);

  return json.table.rows.map(r=>{
    const row = [];
    for(let i=0; i<30; i++){
      row.push(r.c && r.c[i] && r.c[i].v ? r.c[i].v : "");
    }
    return row;
  });
}

/* Cắt vùng (I:J) */
function getRangeRows(rows, startRow, endRow, colStart, colEnd){
  const out = [];
  for(let r = startRow - 1; r <= endRow - 1; r++){
    const row = rows[r] || Array(colEnd).fill("");
    out.push(row.slice(colStart, colEnd));
  }
  return out;
}

/* Render bảng FULL sheet */
function renderFullTable(rows){
  let html = "<table>";
  rows.forEach(r=>{
    html += "<tr>" + r.map(c=>`<td>${c}</td>`).join("") + "</tr>";
  });
  html += "</table>";
  return html;
}

/* Render group I:J */
function renderGroup(title, data){
  let html = `<div class="group-box"><div class="group-title">${title}</div><table>`;
  data.forEach(r=> html += `<tr><td>${r[0]}</td><td>${r[1]}</td></tr>` );
  html += "</table></div>";
  return html;
}

async function loadAll(){
  /* ---- 1. SHEET "doi" (4 khối I:J) ---- */
  const doi = await loadSheet("453451072"); // GID sheet doi

  const g1 = getRangeRows(doi,2,6,8,10);
  const g2 = getRangeRows(doi,11,15,8,10);
  const g3 = getRangeRows(doi,20,24,8,10);
  const g4 = getRangeRows(doi,29,33,8,10);

  document.getElementById("topGroups").innerHTML =
    renderGroup("Nhóm 1", g1) +
    renderGroup("Nhóm 2", g2) +
    renderGroup("Nhóm 3", g3) +
    renderGroup("Nhóm 4", g4);

  /* ---- 2. SHEET bang ---- */
  const bang = await loadSheet("0");
  document.getElementById("sheet_bang").innerHTML = renderFullTable(bang);

  /* ---- 3. SHEET 1.8 ---- */
  const s18 = await loadSheet("2139851109");
  document.getElementById("sheet_18").innerHTML = renderFullTable(s18);

  /* ---- 4. SHEET bk.ck ---- */
  const bkck = await loadSheet("808351424");
  document.getElementById("sheet_bkck").innerHTML = renderFullTable(bkck);

  /* ---- 5. SHEET ck ---- */
  const ck = await loadSheet("815594494");
  document.getElementById("sheet_ck").innerHTML = renderFullTable(ck);
}

loadAll();
</script>

</body>
</html>
