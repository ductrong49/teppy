<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BẢNG THI ĐẤU</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: url("image.jpg") center/cover no-repeat fixed;
        padding: 20px;
        color: #000;
    }
    h1, h2, h3 {
        text-align: center;
        margin: 0;
        padding: 0;
        line-height: 1.3;
        text-shadow: 1px 1px 3px #fff;
    }
    .group {
        margin: 25px 0;
        padding: 10px;
        background: rgba(255,255,255,0.8);
        border-radius: 12px;
        border: 3px solid #2b6cb0;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }
    .group-title {
        font-weight: bold;
        text-align: center;
        margin-bottom: 10px;
        font-size: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        font-size: 18px;
    }
    th, td {
        border: 1px solid #555;
        padding: 6px 10px;
        text-align: center;
        background: white;
    }
    th {
        background: #c6e2ff;
        font-weight: bold;
    }
</style>
</head>
<body>

<h1>TEPPY and LADIES</h1>
<h2>PICKLEBALL CUP</h2>
<h3>21/12/2025</h3>

<div id="groups"></div>

<script>
const SHEET_ID = "1QOnDy3RJydEpNXnuTdRzUTwCNohp00FzZxA7xCraXAY";
const SHEET_NAME = "bang";
const API_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?sheet=${SHEET_NAME}`;

async function loadData() {
    try {
        const res = await fetch(API_URL);
        let text = await res.text();

        text = text.substring(text.indexOf("(") + 1, text.lastIndexOf(")"));
        const json = JSON.parse(text);
        const rows = json.table.rows.map(r => r.c.map(c => c ? c.v : ""));

        renderGroups(rows);
    } catch (e) {
        console.error("Lỗi tải dữ liệu:", e);
    }
}

function getRange(rows, start, end) {
    return rows.slice(start - 1, end);
}

function renderTable(range) {
    let html = "<table>";
    range.forEach((row, idx) => {
        html += "<tr>";
        row.slice(0, 7).forEach(cell => {
            if (idx < 2) {
                html += `<th>${cell}</th>`;
            } else {
                html += `<td>${cell}</td>`;
            }
        });
        html += "</tr>";
    });
    html += "</table>";
    return html;
}

function renderGroups(rows) {
    const groups = [
        { title: "NHÓM 1 (A1:G8)", start: 1, end: 8 },
        { title: "NHÓM 2 (A10:G17)", start: 10, end: 17 },
        { title: "NHÓM 3 (A19:G26)", start: 19, end: 26 },
        { title: "NHÓM 4 (A28:G35)", start: 28, end: 35 }
    ];

    let html = "";
    groups.forEach(g => {
        const range = getRange(rows, g.start, g.end);
        html += `
            <div class="group">
                <div class="group-title">${g.title}</div>
                ${renderTable(range)}
            </div>
        `;
    });

    document.getElementById("groups").innerHTML = html;
}

// Tự cập nhật mỗi 1 giây
loadData();
setInterval(loadData, 1000);
</script>

</body>
</html>
