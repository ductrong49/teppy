<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>B·∫¢NG THI ƒê·∫§U</title>

<style>
  *, *::before, *::after { box-sizing: border-box; }
  html,body { height: 100%; margin: 0; padding: 0; -webkit-text-size-adjust: 100%; }

  :root{
    --card-bg: rgba(255,255,255,0.9);
    --accent-1: #e53e3e;
    --accent-2: #2b6cb0;
    --radius: 12px;
    --gap: 12px;
  }

  body{
    font-family: Arial, sans-serif;
    background: url("image.jpg") center/cover no-repeat;
    padding: 14px;
    color: #111;
    font-size: clamp(15px, 4vw, 20px);
  }

  .container{ max-width: 980px; margin: 0 auto; }

  h1,h2,h3{
    margin: 0;
    padding: 0;
    line-height: 1.2;
    text-align: center;
    text-shadow: 1px 1px 3px rgba(255,255,255,0.6);
  }
  h1{ font-size: 1.25rem; margin-bottom: 4px; }
  h2{ font-size: 1rem; margin-bottom: 6px; }
  h3{ font-size: .9rem; margin-bottom: 10px; }

  .group{
    margin: 18px 0;
    padding: 10px;
    background: var(--card-bg);
    border-radius: var(--radius);
    border: 3px solid var(--accent-2);
    box-shadow: 0 4px 10px rgba(0,0,0,0.12);
  }
  .group-title{
    font-weight: 700;
    text-align: center;
    margin-bottom: 10px;
    font-size: 1rem;
  }

  table{
    width: 100%;
    border-collapse: collapse;
    font-size: 0.78rem;
  }
  th, td{
    border: 1px solid #555;
    padding: 4px 5px;
    text-align: center;
    background: white;
  }
  th{
    background: #c6e2ff;
    font-weight: 700;
  }

  @media(max-width:420px){
    th,td{ padding: 3px 4px; font-size: 0.72rem; }
  }
</style>
</head>

<body>
<div class="container">
  <h1>TEPPY AND LADIES</h1>
  <h2>PICKLEBALL CUP</h2>
  <h3>21/12/2025</h3>

  <div id="bang"></div>

  <!-- üî• sheet 1.8 -->
  <div id="sheet18"></div>

  <!-- üî• sheet bk.ck -->
  <div id="sheetBKCK"></div>
</div>

<script>
const SHEET_ID = "1QOnDy3RJydEpNXnuTdRzUTwCNohp00FzZxA7xCraXAY";

const sheets = [
  { name:"bang",   range:"A:G",  elem:"bang" },
  { name:"1.8",    range:"A:E",  elem:"sheet18" },
  { name:"bk.ck",  range:"A:D",  elem:"sheetBKCK" }
];

async function loadSheet(sheetName){
  let url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?sheet=${sheetName}`;
  let text = await (await fetch(url)).text();
  text = text.substring(text.indexOf("(")+1, text.lastIndexOf(")"));
  return JSON.parse(text).table.rows.map(r => r.c ? r.c.map(c => c?c.v:"") : []);
}

function escape(s){
  if(s === null || s === undefined) return "";
  return String(s).replace(/[&<>"']/g, m => (
    { '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m]
  ));
}

function renderTable(rows, cols){
  let html = "<table>";
  rows.forEach((r, i) => {
    html += "<tr>";
    for(let c=0;c<cols;c++){
      let v = escape(r[c] ?? "");
      html += i === 0 ? `<th>${v}</th>` : `<td>${v}</td>`;
    }
    html += "</tr>";
  });
  html += "</table>";
  return html;
}

async function loadAll(){
  for(const sh of sheets){
    try{
      const rows = await loadSheet(sh.name);

      let title = "";
      if(sh.name==="bang")   title = "B·∫¢NG THI ƒê·∫§U";
      if(sh.name==="1.8")    title = "K·∫æT QU·∫¢ 1.8 (A1:E13)";
      if(sh.name==="bk.ck")  title = "B·∫¢NG BK/CK (A1:D15)";

      let cols = sh.range.split(":")[1].charCodeAt(0) - 65 + 1;

      document.getElementById(sh.elem).innerHTML = `
        <div class="group">
          <div class="group-title">${title}</div>
          ${renderTable(rows, cols)}
        </div>
      `;
    }catch(e){
      document.getElementById(sh.elem).innerHTML =
        `<div class="group"><div class="group-title">L·ªñI T·∫¢I ${sh.name}</div></div>`;
    }
  }
}

loadAll();
setInterval(loadAll, 5000);
</script>

</body>
</html>
